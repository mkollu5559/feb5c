--liquibase formatted sql 
--changeset cc:2026.01.28.02 runAlways:false stripComments:false splitStatements:false

DELETE  FROM HSABC${env.id.upper}.ABCDetail WHERE AuditDataID IN (
SELECT AuditDataID FROM  HSABC${env.id.upper}.ABCHeader WHERE ProcessID IN (
SELECT ProcessID FROM HSABC${env.id.upper}.ABCProcess WHERE ProcessName IN (
'SDOH_SRC_TO_FILE_LOAD'
)));
DELETE FROM HSABC${env.id.upper}.ABCHeader WHERE ProcessID IN (
SELECT ProcessID FROM HSABC${env.id.upper}.ABCProcess WHERE ProcessName IN (
'SDOH_SRC_TO_FILE_LOAD'
));
DELETE  FROM HSABC${env.id.upper}.ABCDataBridge WHERE BridgeID IN (
SELECT BridgeID FROM HSABC${env.id.upper}.ABCProcessFlow WHERE ProcessID IN (
SELECT ProcessID FROM HSABC${env.id.upper}.ABCProcess WHERE ProcessName IN (
'SDOH_SRC_TO_FILE_LOAD'
)));
DELETE FROM HSABC${env.id.upper}.ABCQueryMaster WHERE BridgeID IN (
SELECT BridgeID FROM HSABC${env.id.upper}.ABCProcessFlow WHERE ProcessID IN (
SELECT ProcessID FROM HSABC${env.id.upper}.ABCProcess WHERE ProcessName IN (
'SDOH_SRC_TO_FILE_LOAD'
)));
DELETE  FROM  HSABC${env.id.upper}.ABCPROCESSINCREMENTALCONTROL WHERE PROCESSID IN (
SELECT PROCESSID FROM HSABC${env.id.upper}.ABCPROCESS WHERE PROCESSNAME IN (
'SDOH_SRC_TO_FILE_LOAD'
));
DELETE FROM HSABC${env.id.upper}.ABCProcess WHERE ProcessName IN (
'SDOH_SRC_TO_FILE_LOAD'
);
DELETE FROM HSABC${env.id.upper}.ABCQueryMaster WHERE BridgeID IN (
SELECT BridgeID FROM HSABC${env.id.upper}.ABCDataBridge WHERE FROM_NodeID IN (
SELECT nodeID FROM HSABC${env.id.upper}.AbcDataNode WHERE ABCObjectID IN (
SELECT ABCObjectID FROM  HSABC${env.id.upper}.ABCObjects WHERE TableName_FilePattern IN (
'SDOH_SRC_TO_FILE_LOAD'
))));
DELETE FROM HSABC${env.id.upper}.ABCQueryMaster WHERE BridgeID IN (
SELECT BridgeID FROM HSABC${env.id.upper}.ABCDataBridge WHERE TO_NodeID  IN (
SELECT nodeID FROM HSABC${env.id.upper}.AbcDataNode WHERE ABCObjectID IN (
SELECT ABCObjectID FROM  HSABC${env.id.upper}.ABCObjects WHERE TableName_FilePattern IN (
'SDOH_SRC_TO_FILE_LOAD'
))));
DELETE FROM HSABC${env.id.upper}.ABCDetail WHERE BridgeID IN (
SELECT BridgeID FROM HSABC${env.id.upper}.ABCDataBridge WHERE FROM_NodeID IN (
SELECT nodeID FROM HSABC${env.id.upper}.AbcDataNode WHERE ABCObjectID IN (
SELECT ABCObjectID FROM  HSABC${env.id.upper}.ABCObjects WHERE TableName_FilePattern IN (
'SDOH_SRC_TO_FILE_LOAD'
))));
DELETE FROM HSABC${env.id.upper}.ABCDetail WHERE BridgeID IN (
SELECT BridgeID FROM HSABC${env.id.upper}.ABCDataBridge WHERE TO_NodeID  IN (
SELECT nodeID FROM HSABC${env.id.upper}.AbcDataNode WHERE ABCObjectID IN (
SELECT ABCObjectID FROM  HSABC${env.id.upper}.ABCObjects WHERE TableName_FilePattern IN (
'SDOH_SRC_TO_FILE_LOAD'
))));
DELETE FROM HSABC${env.id.upper}.ABCProcessFlow WHERE BridgeID IN (
SELECT BridgeID FROM HSABC${env.id.upper}.ABCDataBridge WHERE FROM_NodeID IN (
SELECT nodeID FROM HSABC${env.id.upper}.AbcDataNode WHERE ABCObjectID IN (
SELECT ABCObjectID FROM  HSABC${env.id.upper}.ABCObjects WHERE TableName_FilePattern IN (
'SDOH_SRC_TO_FILE_LOAD'
))));
DELETE FROM HSABC${env.id.upper}.ABCProcessFlow WHERE BridgeID IN (
SELECT BridgeID FROM HSABC${env.id.upper}.ABCDataBridge WHERE TO_NodeID  IN (
SELECT nodeID FROM HSABC${env.id.upper}.AbcDataNode WHERE ABCObjectID IN (
SELECT ABCObjectID FROM  HSABC${env.id.upper}.ABCObjects WHERE TableName_FilePattern IN (
'SDOH_SRC_TO_FILE_LOAD'
))));
DELETE FROM HSABC${env.id.upper}.ABCDataBridge WHERE FROM_NodeID IN (
SELECT nodeID FROM HSABC${env.id.upper}.AbcDataNode WHERE ABCObjectID IN (
SELECT ABCObjectID FROM  HSABC${env.id.upper}.ABCObjects WHERE TableName_FilePattern IN (
'SDOH_SRC_TO_FILE_LOAD'
)))
OR
TO_NodeID  IN (SELECT nodeID FROM HSABC${env.id.upper}.AbcDataNode WHERE ABCObjectID IN (
SELECT ABCObjectID FROM  HSABC${env.id.upper}.ABCObjects WHERE TableName_FilePattern IN (
'SDOH_SRC_TO_FILE_LOAD'
)));
DELETE FROM HSABC${env.id.upper}.AbcDataNode WHERE ABCObjectID IN (
SELECT ABCObjectID FROM  HSABC${env.id.upper}.ABCObjects WHERE TableName_FilePattern IN (
'SDOH_SRC_TO_FILE_LOAD'
)) ;
DELETE FROM HSABC${env.id.upper}.ABCObjects WHERE TableName_FilePattern IN (
'SDOH_SRC_TO_FILE_LOAD'
);
DELETE FROM HSABC${env.id.upper}.ABCProcessFlow WHERE ProcessID IN (
SELECT ProcessID FROM HSABC${env.id.upper}.ABCProcess WHERE ProcessName IN (
'SDOH_SRC_TO_FILE_LOAD'
)
);

	/* DONT CHANGE LOWER CASE Values */
	CREATE VOLATILE TABLE ENV_ID_CHK (ENVID VARCHAR(10))
	PRIMARY INDEX(ENVID)
	ON COMMIT PRESERVE ROWS;

	COLLECT STATS COLUMN (ENVID) ON ENV_ID_CHK ;

	INSERT INTO ENV_ID_CHK VALUES('${env.id}');

	SELECT ENVID FROM ENV_ID_CHK WHERE ENVID = 'dev2';
	.IF ACTIVITYCOUNT > 0 THEN .GOTO DEV2_STMNT
	SELECT ENVID FROM ENV_ID_CHK WHERE ENVID = 'dev';
	.IF ACTIVITYCOUNT > 0 THEN .GOTO DEV_STMNT
	SELECT ENVID FROM ENV_ID_CHK WHERE ENVID = 'uat';
	.IF ACTIVITYCOUNT > 0 THEN .GOTO UAT_STMNT
	SELECT ENVID FROM ENV_ID_CHK WHERE ENVID = 'qa';
	.IF ACTIVITYCOUNT > 0 THEN .GOTO QA_STMNT
	SELECT ENVID FROM ENV_ID_CHK WHERE ENVID = 'int';
	.IF ACTIVITYCOUNT > 0 THEN .GOTO INT_STMNT
	SELECT ENVID FROM ENV_ID_CHK WHERE ENVID = 'prd';
	.IF ACTIVITYCOUNT > 0 THEN .GOTO PROD_STMNT


	.GOTO DROPVT


	.LABEL DEV2_STMNT

	CALL  HSPROCS${env.id.upper}.ABC_METADATA_INSERT('Sharepoint','HSTNTDDEV','$SERVER\OSS_Inbound\External\Med_adherence\AdhereHealth','PHARMACY_FILELAND_DEV2_T','*SDOHActivity*','CMS_SDOHRAW','FILE_TO_TD','NA','NA','NA','NA','NA','NA','NA','SDOH_SRC_TO_FILE_LOAD',249,'Load RXANTE PATIENT LIST MAPD data from File to Core','FULL','Monthly',1,'SRC_TO_FILELAND','CNT_FILE','','NA','Select count(*) from PHARMACY_FILELAND_DEV2_V.CMS_SDOHRAW','',p_RESULT);
	CALL  HSPROCS${env.id.upper}.ABC_METADATA_INSERT('HSTNTDDEV','HSTNTDDEV','PHARMACY_FILELAND_DEV2_T','PHARMACY_STAGE_DEV2_T','CMS_SDOHRAW','CMS_SDOHRAW','TD_TO_TD','NA','NA','NA','NA','NA','NA','NA','SDOH_SRC_TO_FILE_LOAD',249,'Load RXANTE PATIENT LIST MAPD data from File to Core','FULL','Monthly',2,'FLLD_TO_STG','CNT','','Select count(*) from PHARMACY_FILELAND_DEV2_V.CMS_SDOHRAW','Select count(*) from PHARMACY_STAGE_DEV2_V.CMS_SDOHRAW','',p_RESULT);
	CALL  HSPROCS${env.id.upper}.ABC_METADATA_INSERT('HSTNTDDEV','HSTNTDDEV','PHARMACY_STAGE_DEV2_T','PHARMACY_CORE_DEV2_T','CMS_SDOHRAW','CMS_SDOHRAW','TD_TO_TD','NA','NA','NA','NA','NA','NA','NA','SDOH_SRC_TO_FILE_LOAD',249,'Load RXANTE PATIENT LIST MAPD data from File to Core','INCR','Monthly',3,'STG_TO_CORE','CNT','','Select count(*) from PHARMACY_STAGE_DEV2_V.CMS_SDOHRAW','Select count(*) from PHARMACY_CORE_DEV2_V.CMS_SDOHRAW WHERE LOAD_DTTM IN (SELECT MAX(LOAD_DTTM) FROM  PHARMACY_CORE_DEV2_V.CMS_SDOHRAW) ','',p_RESULT);

	UPDATE HSABC${env.id.upper}.ImportFile_FileDetail SET FilePath	= '$SERVER\OSS_Inbound\External\Med_adherence\AdhereHealth', ErrorPath   = '$SERVER\OSS_Inbound\External\Med_adherence\AdhereHealth\Error', ArchivePath = '$SERVER\OSS_Inbound\External\Med_adherence\AdhereHealth\Archive', FilePattern = '*SDOHActivity*' WHERE SourceID = (SELECT SourceID FROM HSABC${env.id.upper}.ImportFile_Source WHERE SourceName='SXC') AND FileTypeID = (SELECT FileTypeID FROM HSABC${env.id.upper}.ImportFile_FileType WHERE FileType='SDOHData');

	UPDATE HSABC${env.id.upper}.Src_FileLoad_Control SET FILE_PATH = '$SERVER\OSS_Inbound\External\Med_adherence\AdhereHealth', FILE_FORMAT = '*SDOHActivity*' WHERE PROCESS_NM = 'SDOH_SRC_TO_FILE_LOAD';



	.GOTO DROPVT

	.LABEL DEV_STMNT

  	CALL  HSPROCS${env.id.upper}.ABC_METADATA_INSERT_DM('Sharepoint','HSTNTDUAT','$SERVER\OSS_Inbound\External\Med_adherence\AdhereHealth','PHARMACY_FILELAND_DEV_T','*SDOHActivity*','CMS_SDOHRAW ','FILE_TO_TD','','','','','','FlatFile','Healthspring','PHARMACY_SDOH_FULL',32,'Load SDOH Data to TD','FULL','DAILY',1,'FILE_TO_TD','CNT_FILE','','Not Applicable','Select count(*) from PHARMACY_FILELAND_DEV_V.CMS_SDOHRAW','','','','','',p_RESULT);
	CALL  HSPROCS${env.id.upper}.ABC_METADATA_INSERT_DM('HSTNTDUAT','HSTNTDUAT','PHARMACY_FILELAND_DEV_T','PHARMACY_STAGE_DEV_T','CMS_SDOHRAW','AH_SDOH_Activity','TD_TO_TD','','','','','','Healthspring','Healthspring','PHARMACY_SDOH_FULL',32,'Load SDOH Data to TD','FULL','DAILY',2,'FILELAND_DEV_TO_STAGE','CNT','','Select count(*) from PHARMACY_FILELAND_DEV_V.CMS_SDOHRAW','Select count(*) from PHARMACY_STAGE_DEV_V.AH_SDOH_Activity','','','','','',p_RESULT);
	CALL  HSPROCS${env.id.upper}.ABC_METADATA_INSERT_DM('HSTNTDUAT','HSTNTDUAT','PHARMACY_STAGE_DEV_T','PHARMACY_CORE_DEV_T','AH_SDOH_Activity','AH_SDOH_Activity','TD_TO_TD','','','','','','Healthspring','Healthspring','PHARMACY_SDOH_FULL',32,'Load SDOH Data to TD','FULL','DAILY',3,'STG_TO_CORE','CNT','','Select count(*) from PHARMACY_STAGE_DEV_V.AH_SDOH_Activity','Select count(*) from PHARMACY_FILELAND_DEV_V.AH_SDOH_Activity','','','','','',p_RESULT);

	UPDATE HSABC${env.id.upper}.ImportFile_FileDetail SET FilePath	= '$SERVER\OSS_Inbound\External\Med_adherence\AdhereHealth', ErrorPath   = '$SERVER\OSS_Inbound\External\Med_adherence\AdhereHealth\Error', ArchivePath = '$SERVER\OSS_Inbound\External\Med_adherence\AdhereHealth\Archive', FilePattern = '*SDOHActivity*' WHERE SourceID = (SELECT SourceID FROM HSABC${env.id.upper}.ImportFile_Source WHERE SourceName='SXC') AND FileTypeID = (SELECT FileTypeID FROM HSABC${env.id.upper}.ImportFile_FileType WHERE FileType='SDOHData');
	
	UPDATE HSABC${env.id.upper}.Src_FileLoad_Control SET FILE_PATH = '$SERVER\OSS_Inbound\External\Med_adherence\AdhereHealth', FILE_FORMAT = '*SDOHActivity*' WHERE PROCESS_NM = 'SDOH_SRC_TO_FILE_LOAD';


	

	.GOTO DROPVT

	.LABEL UAT_STMNT


	CALL  HSPROCS${env.id.upper}.ABC_METADATA_INSERT_DM('Sharepoint','HSTNTDUAT','$SERVER\OSS_Inbound\External\Med_adherence\AdhereHealth','PHARMACY_FILELAND_T','*SDOHActivity*','CMS_SDOHRAW ','FILE_TO_TD','','','','','','FlatFile','Healthspring','PHARMACY_SDOH_FULL',32,'Load SDOH Data to TD','FULL','DAILY',1,'FILE_TO_TD','CNT_FILE','','Not Applicable','Select count(*) from PHARMACY_FILELAND_V.CMS_SDOHRAW','','','','','',p_RESULT);
	CALL  HSPROCS${env.id.upper}.ABC_METADATA_INSERT_DM('HSTNTDUAT','HSTNTDUAT','PHARMACY_FILELAND_T','PHARMACY_STAGE_T','CMS_SDOHRAW','AH_SDOH_Activity','TD_TO_TD','','','','','','Healthspring','Healthspring','PHARMACY_SDOH_FULL',32,'Load SDOH Data to TD','FULL','DAILY',2,'FILELAND_TO_STAGE','CNT','','Select count(*) from PHARMACY_FILELAND_V.CMS_SDOHRAW','Select count(*) from PHARMACY_STAGE_V.AH_SDOH_Activity','','','','','',p_RESULT);
	CALL  HSPROCS${env.id.upper}.ABC_METADATA_INSERT_DM('HSTNTDUAT','HSTNTDUAT','PHARMACY_STAGE_T','PHARMACY_CORE_T','AH_SDOH_Activity','AH_SDOH_Activity','TD_TO_TD','','','','','','Healthspring','Healthspring','PHARMACY_SDOH_FULL',32,'Load SDOH Data to TD','FULL','DAILY',3,'STG_TO_CORE','CNT','','Select count(*) from PHARMACY_STAGE_V.AH_SDOH_Activity','Select count(*) from PHARMACY_CORE_V.AH_SDOH_Activity','','','','','',p_RESULT);

	UPDATE HSABC${env.id.upper}.ImportFile_FileDetail SET FilePath	= '$SERVER\OSS_Inbound\External\Med_adherence\AdhereHealth', ErrorPath   = '$SERVER\OSS_Inbound\External\Med_adherence\AdhereHealth\Error', ArchivePath = '$SERVER\OSS_Inbound\External\Med_adherence\AdhereHealth\Archive', FilePattern = '*SDOHActivity*' WHERE SourceID = (SELECT SourceID FROM HSABC${env.id.upper}.ImportFile_Source WHERE SourceName='SXC') AND FileTypeID = (SELECT FileTypeID FROM HSABC${env.id.upper}.ImportFile_FileType WHERE FileType='SDOHData');
	
	UPDATE HSABC${env.id.upper}.Src_FileLoad_Control SET FILE_PATH = '$SERVER\OSS_Inbound\External\Med_adherence\AdhereHealth', FILE_FORMAT = '*SDOHActivity*' WHERE PROCESS_NM = 'SDOH_SRC_TO_FILE_LOAD';


	.GOTO DROPVT

	.LABEL QA_STMNT


	CALL  HSPROCS${env.id.upper}.ABC_METADATA_INSERT_DM('Sharepoint','HSTNTDUAT','$SERVER\OSS_Inbound\External\Med_adherence\AdhereHealth','PHARMACY_FILELAND_QA_T','*SDOHActivity*','CMS_SDOHRAW ','FILE_TO_TD','','','','','','FlatFile','Healthspring','PHARMACY_SDOH_FULL',32,'Load SDOH Data to TD','FULL','DAILY',1,'FILE_TO_TD','CNT_FILE','','Not Applicable','Select count(*) from PHARMACY_FILELAND_QA_V.CMS_SDOHRAW','','','','','',p_RESULT);
	CALL  HSPROCS${env.id.upper}.ABC_METADATA_INSERT_DM('HSTNTDUAT','HSTNTDUAT','PHARMACY_FILELAND_QA_T','PHARMACY_STAGE_QA_T','CMS_SDOHRAW','AH_SDOH_Activity','TD_TO_TD','','','','','','Healthspring','Healthspring','PHARMACY_SDOH_FULL',32,'Load SDOH Data to TD','FULL','DAILY',2,'FILELAND_QA_TO_STAGE','CNT','','Select count(*) from PHARMACY_FILELAND_QA_V.CMS_SDOHRAW','Select count(*) from PHARMACY_STAGE_QA_V.AH_SDOH_Activity','','','','','',p_RESULT);
	CALL  HSPROCS${env.id.upper}.ABC_METADATA_INSERT_DM('HSTNTDUAT','HSTNTDUAT','PHARMACY_STAGE_QA_T','PHARMACY_CORE_QA_T','AH_SDOH_Activity','AH_SDOH_Activity','TD_TO_TD','','','','','','Healthspring','Healthspring','PHARMACY_SDOH_FULL',32,'Load SDOH Data to TD','FULL','DAILY',3,'STG_TO_CORE','CNT','','Select count(*) from PHARMACY_STAGE_QA_V.AH_SDOH_Activity','Select count(*) from PHARMACY_FILELAND_QA_V.AH_SDOH_Activity','','','','','',p_RESULT);

	UPDATE HSABC${env.id.upper}.ImportFile_FileDetail SET FilePath	= '$SERVER\OSS_Inbound\External\Med_adherence\AdhereHealth', ErrorPath   = '$SERVER\OSS_Inbound\External\Med_adherence\AdhereHealth\Error', ArchivePath = '$SERVER\OSS_Inbound\External\Med_adherence\AdhereHealth\Archive', FilePattern = '*SDOHActivity*' WHERE SourceID = (SELECT SourceID FROM HSABC${env.id.upper}.ImportFile_Source WHERE SourceName='SXC') AND FileTypeID = (SELECT FileTypeID FROM HSABC${env.id.upper}.ImportFile_FileType WHERE FileType='SDOHData');
	
	UPDATE HSABC${env.id.upper}.Src_FileLoad_Control SET FILE_PATH = '$SERVER\OSS_Inbound\External\Med_adherence\AdhereHealth', FILE_FORMAT = '*SDOHActivity*' WHERE PROCESS_NM = 'SDOH_SRC_TO_FILE_LOAD';



	.GOTO DROPVT

	.LABEL INT_STMNT


	CALL  HSPROCS${env.id.upper}.ABC_METADATA_INSERT_DM('Sharepoint','HSTNTDUAT','$SERVER\OSS_Inbound\External\Med_adherence\AdhereHealth','PHARMACY_FILELAND_INT_T','*SDOHActivity*','CMS_SDOHRAW ','FILE_TO_TD','','','','','','FlatFile','Healthspring','PHARMACY_SDOH_FULL',32,'Load SDOH Data to TD','FULL','DAILY',1,'FILE_TO_TD','CNT_FILE','','Not Applicable','Select count(*) from PHARMACY_STAGE_INT_V.CMS_SDOHRAW','','','','','',p_RESULT);
	CALL  HSPROCS${env.id.upper}.ABC_METADATA_INSERT_DM('HSTNTDUAT','HSTNTDUAT','PHARMACY_FILELAND_INT_T','PHARMACY_STAGE_INT_T','CMS_SDOHRAW','AH_SDOH_Activity','TD_TO_TD','','','','','','Healthspring','Healthspring','PHARMACY_SDOH_FULL',32,'Load SDOH Data to TD','FULL','DAILY',2,'FILELAND_INT_TO_STAGE','CNT','','Select count(*) from PHARMACY_STAGE_INT_V.CMS_SDOHRAW','Select count(*) from PHARMACY_STAGE_INT_V.AH_SDOH_Activity','','','','','',p_RESULT);
	CALL  HSPROCS${env.id.upper}.ABC_METADATA_INSERT_DM('HSTNTDUAT','HSTNTDUAT','PHARMACY_STAGE_INT_T','PHARMACY_CORE_INT_T','AH_SDOH_Activity','AH_SDOH_Activity','TD_TO_TD','','','','','','Healthspring','Healthspring','PHARMACY_SDOH_FULL',32,'Load SDOH Data to TD','FULL','DAILY',3,'STG_TO_CORE','CNT','','Select count(*) from PHARMACY_STAGE_INT_V.AH_SDOH_Activity','Select count(*) from PHARMACY_STAGE_INT_V.AH_SDOH_Activity','','','','','',p_RESULT);
	

	UPDATE HSABC${env.id.upper}.ImportFile_FileDetail SET FilePath	= '$SERVER\OSS_Inbound\External\Med_adherence\AdhereHealth', ErrorPath   = '$SERVER\OSS_Inbound\External\Med_adherence\AdhereHealth\Error', ArchivePath = '$SERVER\OSS_Inbound\External\Med_adherence\AdhereHealth\Archive', FilePattern = '*SDOHActivity*' WHERE SourceID = (SELECT SourceID FROM HSABC${env.id.upper}.ImportFile_Source WHERE SourceName='SXC') AND FileTypeID = (SELECT FileTypeID FROM HSABC${env.id.upper}.ImportFile_FileType WHERE FileType='SDOHData');
	
	UPDATE HSABC${env.id.upper}.Src_FileLoad_Control SET FILE_PATH = '$SERVER\OSS_Inbound\External\Med_adherence\AdhereHealth', FILE_FORMAT = '*SDOHActivity*' WHERE PROCESS_NM = 'SDOH_SRC_TO_FILE_LOAD';




	.GOTO DROPVT

	.LABEL PROD_STMNT


	CALL  HSPROCS${env.id.upper}.ABC_METADATA_INSERT_DM('Sharepoint','HSTNTDPROD','$SERVER\OSS_Inbound\External\Med_adherence\AdhereHealth','PHARMACY_FILELAND_T','*SDOHActivity*','CMS_SDOHRAW ','FILE_TO_TD','','','','','','FlatFile','Healthspring','PHARMACY_SDOH_FULL',32,'Load SDOH Data to TD','FULL','DAILY',1,'FILE_TO_TD','CNT_FILE','','Not Applicable','Select count(*) from PHARMACY_FILELAND_V.CMS_SDOHRAW','','','','','',p_RESULT);
	CALL  HSPROCS${env.id.upper}.ABC_METADATA_INSERT_DM('HSTNTDPROD','HSTNTDPROD','PHARMACY_FILELAND_T','PHARMACY_STAGE_T','CMS_SDOHRAW','AH_SDOH_Activity','TD_TO_TD','','','','','','Healthspring','Healthspring','PHARMACY_SDOH_FULL',32,'Load SDOH Data to TD','FULL','DAILY',2,'FILELAND_TO_STAGE','CNT','','Select count(*) from PHARMACY_FILELAND_V.CMS_SDOHRAW','Select count(*) from PHARMACY_STAGE_V.AH_SDOH_Activity','','','','','',p_RESULT);
	CALL  HSPROCS${env.id.upper}.ABC_METADATA_INSERT_DM('HSTNTDPROD','HSTNTDPROD','PHARMACY_STAGE_T','PHARMACY_CORE_T','AH_SDOH_Activity','AH_SDOH_Activity','TD_TO_TD','','','','','','Healthspring','Healthspring','PHARMACY_SDOH_FULL',32,'Load SDOH Data to TD','FULL','DAILY',3,'STG_TO_CORE','CNT','','Select count(*) from PHARMACY_STAGE_V.AH_SDOH_Activity','Select count(*) from PHARMACY_CORE_V.AH_SDOH_Activity','','','','','',p_RESULT);


	UPDATE HSABC${env.id.upper}.ImportFile_FileDetail SET FilePath	= '$SERVER\OSS_Inbound\External\Med_adherence\AdhereHealth', ErrorPath   = '$SERVER\OSS_Inbound\External\Med_adherence\AdhereHealth\Error', ArchivePath = '$SERVER\OSS_Inbound\External\Med_adherence\AdhereHealth\Archive', FilePattern = '*SDOHActivity*' WHERE SourceID = (SELECT SourceID FROM HSABC${env.id.upper}.ImportFile_Source WHERE SourceName='SXC') AND FileTypeID = (SELECT FileTypeID FROM HSABC${env.id.upper}.ImportFile_FileType WHERE FileType='SDOHData');
	
	UPDATE HSABC${env.id.upper}.Src_FileLoad_Control SET FILE_PATH = '$SERVER\OSS_Inbound\External\Med_adherence\AdhereHealth', FILE_FORMAT = '*SDOHActivity*' WHERE PROCESS_NM = 'SDOH_SRC_TO_FILE_LOAD';



		
	.GOTO DROPVT

	.LABEL DROPVT
	DROP TABLE ENV_ID_CHK;

	--rollback drop table Deployment_Test;
